{"operators":[{"operatorID":"CSVFileScan-operator-d61df651-6f61-4242-a78b-c77d246e8bc3","operatorType":"CSVFileScan","operatorVersion":"c14deb143ea86b24f718654c929cfd618cbd4503","operatorProperties":{"fileEncoding":"UTF_8","customDelimiter":",","hasHeader":true,"fileName":"/Users/yicong-huang/Downloads/new-dataset_sentiment-ideology-merged.csv","limit":null,"offset":null},"inputPorts":[],"outputPorts":[{"portID":"output-0","displayName":"","allowMultiInputs":false,"isDynamicPort":false}],"showAdvanced":false,"isDisabled":false,"customDisplayName":"tweets","dynamicInputPorts":false,"dynamicOutputPorts":false},{"operatorID":"SimpleSink-operator-54b44d72-1944-4769-b0ed-84a3f3f45257","operatorType":"SimpleSink","operatorVersion":"f82d0affafcba93dada5e3d1e9f3367e5b53d037","operatorProperties":{},"inputPorts":[{"portID":"input-0","displayName":"","allowMultiInputs":false,"isDynamicPort":false}],"outputPorts":[],"showAdvanced":false,"isDisabled":false,"customDisplayName":"View Results","dynamicInputPorts":false,"dynamicOutputPorts":false},{"operatorID":"Projection-operator-31401ea9-24ab-4a63-929b-8e6a2a893178","operatorType":"Projection","operatorVersion":"241993a4c41e2a402a0f06e5f6e91202ea3184ce","operatorProperties":{"attributes":[{"originalAttribute":"id","alias":""},{"originalAttribute":"text","alias":""},{"originalAttribute":"created_at","alias":""}]},"inputPorts":[{"portID":"input-0","displayName":"","allowMultiInputs":false,"isDynamicPort":false}],"outputPorts":[{"portID":"output-0","displayName":"","allowMultiInputs":false,"isDynamicPort":false}],"showAdvanced":false,"isDisabled":false,"customDisplayName":"Projection","dynamicInputPorts":false,"dynamicOutputPorts":false},{"operatorID":"PythonUDFV2-operator-e6e9797a-fe9d-444a-bc43-1f28f42b9f03","operatorType":"PythonUDFV2","operatorVersion":"f82d0affafcba93dada5e3d1e9f3367e5b53d037","operatorProperties":{"code":"# Choose from the following templates:\n# \nfrom pytexera import *\n\nimport spacy\nfrom textblob import TextBlob\n\n# Load the small English model\nnlp = spacy.load(\"en_core_web_sm\")\n\ndef get_pos_tags(text):\n    \"\"\"\n    Takes a text string and returns a list of (token, POS) tuples.\n    \n    Args:\n    text (str): The input text to be processed.\n    \n    Returns:\n    List[Tuple[str, str]]: A list of tuples, where each tuple contains a token and its corresponding POS tag.\n    \"\"\"\n    doc = nlp(text)  # Process the text using spaCy\n    pos_tags = [(token.text, token.pos_) for token in doc]  # Create a list of (token, POS) pairs\n    return pos_tags\n\n\nclass ProcessTupleOperator(UDFOperatorV2):\n    \n    @overrides\n    def process_tuple(self, tuple_: Tuple, port: int) -> Iterator[Optional[TupleLike]]:\n        for token, pos in get_pos_tags(tuple_['text']):\n            yield {\"token\": token, \"pos\": pos}\n    \n# \n# class ProcessBatchOperator(UDFBatchOperator):\n#     BATCH_SIZE = 10 # must be a positive integer\n# \n#     @overrides\n#     def process_batch(self, batch: Batch, port: int) -> Iterator[Optional[BatchLike]]:\n#         yield batch\n# \n# class ProcessTableOperator(UDFTableOperator):\n# \n#     @overrides\n#     def process_table(self, table: Table, port: int) -> Iterator[Optional[TableLike]]:\n#         yield table\n","retainInputColumns":false,"outputColumns":[{"attributeName":"token","attributeType":"string"},{"attributeName":"pos","attributeType":"string"}],"workers":1},"inputPorts":[{"portID":"input-0","displayName":"","allowMultiInputs":true,"isDynamicPort":false}],"outputPorts":[{"portID":"output-0","displayName":"","allowMultiInputs":false,"isDynamicPort":false}],"showAdvanced":false,"isDisabled":false,"customDisplayName":"spaCy Sentiment","dynamicInputPorts":true,"dynamicOutputPorts":true},{"operatorID":"CSVFileScan-operator-c3adba4e-db10-436a-a443-a3877a9ee29b","operatorType":"CSVFileScan","operatorVersion":"c14deb143ea86b24f718654c929cfd618cbd4503","operatorProperties":{"fileEncoding":"UTF_8","customDelimiter":",","hasHeader":true,"fileName":"/Users/yicong-huang/Downloads/new-dataset_sentiment-ideology-merged.csv","limit":3000,"offset":null},"inputPorts":[],"outputPorts":[{"portID":"output-0","displayName":"","allowMultiInputs":false,"isDynamicPort":false}],"showAdvanced":false,"isDisabled":false,"customDisplayName":"ideology scores","dynamicInputPorts":false,"dynamicOutputPorts":false},{"operatorID":"HashJoin-operator-17a55d8e-202a-4709-9f37-b508797f2a84","operatorType":"HashJoin","operatorVersion":"7f29d4fe25a98a78bf32830591ff3a78477fa94b","operatorProperties":{"joinType":"inner","buildAttributeName":"id","probeAttributeName":"id"},"inputPorts":[{"portID":"input-0","displayName":"left","allowMultiInputs":false,"isDynamicPort":false},{"portID":"input-1","displayName":"right","allowMultiInputs":false,"isDynamicPort":false}],"outputPorts":[{"portID":"output-0","displayName":"","allowMultiInputs":false,"isDynamicPort":false}],"showAdvanced":false,"isDisabled":false,"customDisplayName":"Hash Join","dynamicInputPorts":false,"dynamicOutputPorts":false},{"operatorID":"Filter-operator-33495260-ae7c-4963-a8f3-cb5cb03de8d6","operatorType":"Filter","operatorVersion":"f82d0affafcba93dada5e3d1e9f3367e5b53d037","operatorProperties":{"predicates":[{"attribute":"created_at","value":"2019-08-08","condition":">"}]},"inputPorts":[{"portID":"input-0","displayName":"","allowMultiInputs":false,"isDynamicPort":false}],"outputPorts":[{"portID":"output-0","displayName":"","allowMultiInputs":false,"isDynamicPort":false}],"showAdvanced":false,"isDisabled":false,"customDisplayName":"Filter","dynamicInputPorts":false,"dynamicOutputPorts":false}],"operatorPositions":{"CSVFileScan-operator-d61df651-6f61-4242-a78b-c77d246e8bc3":{"x":0,"y":160},"SimpleSink-operator-54b44d72-1944-4769-b0ed-84a3f3f45257":{"x":700,"y":80},"Projection-operator-31401ea9-24ab-4a63-929b-8e6a2a893178":{"x":140,"y":160},"PythonUDFV2-operator-e6e9797a-fe9d-444a-bc43-1f28f42b9f03":{"x":560,"y":80},"CSVFileScan-operator-c3adba4e-db10-436a-a443-a3877a9ee29b":{"x":140,"y":0},"HashJoin-operator-17a55d8e-202a-4709-9f37-b508797f2a84":{"x":280,"y":80},"Filter-operator-33495260-ae7c-4963-a8f3-cb5cb03de8d6":{"x":420,"y":80}},"links":[{"linkID":"link-6c60682f-973a-4887-9525-2fb2bd658b57","source":{"operatorID":"CSVFileScan-operator-d61df651-6f61-4242-a78b-c77d246e8bc3","portID":"output-0"},"target":{"operatorID":"Projection-operator-31401ea9-24ab-4a63-929b-8e6a2a893178","portID":"input-0"}},{"linkID":"link-aaa066b4-90a1-40ec-97bf-cbb6b72010c4","source":{"operatorID":"PythonUDFV2-operator-e6e9797a-fe9d-444a-bc43-1f28f42b9f03","portID":"output-0"},"target":{"operatorID":"SimpleSink-operator-54b44d72-1944-4769-b0ed-84a3f3f45257","portID":"input-0"}},{"linkID":"fa963efd-817a-4a26-86ff-97df776d3e1f","source":{"operatorID":"CSVFileScan-operator-c3adba4e-db10-436a-a443-a3877a9ee29b","portID":"output-0"},"target":{"operatorID":"HashJoin-operator-17a55d8e-202a-4709-9f37-b508797f2a84","portID":"input-0"}},{"linkID":"7ed973d3-134c-4872-bad5-e324b87f083b","source":{"operatorID":"Projection-operator-31401ea9-24ab-4a63-929b-8e6a2a893178","portID":"output-0"},"target":{"operatorID":"HashJoin-operator-17a55d8e-202a-4709-9f37-b508797f2a84","portID":"input-1"}},{"linkID":"d82d5e36-8e6a-45c1-b946-652cb892105e","source":{"operatorID":"HashJoin-operator-17a55d8e-202a-4709-9f37-b508797f2a84","portID":"output-0"},"target":{"operatorID":"Filter-operator-33495260-ae7c-4963-a8f3-cb5cb03de8d6","portID":"input-0"}},{"linkID":"c3987d97-9ccb-417d-a4c1-f7bf2ab99a6c","source":{"operatorID":"Filter-operator-33495260-ae7c-4963-a8f3-cb5cb03de8d6","portID":"output-0"},"target":{"operatorID":"PythonUDFV2-operator-e6e9797a-fe9d-444a-bc43-1f28f42b9f03","portID":"input-0"}}],"groups":[],"breakpoints":{},"commentBoxes":[]}